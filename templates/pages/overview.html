{% extends "base.html" %}
{% block content %}

<div class="hero container">
  <h1>GeoTiny EDU — Project‑Based Seismology</h1>
  <p>Live monitoring for GeoTiny stations with a global earthquake feed. Use this page to view the local instrument and recent worldwide events; deeper teaching material is on the Education page.</p>
</div>

<div class="container">

  <!-- Introduction (concise) -->
  <div class="card mb-4">
    <div class="card-header">Introduction</div>
    <div class="card-body">
      <p>
        This Overview keeps operations front‑and‑center: the vendor UI for the local station and a live global seismic panel.
        Learning goals, background theory, and exercises have moved to the Education page.
      </p>
    </div>
  </div>

  <!-- Local instrument — live vendor UI (via proxy) -->
  <div class="card mb-4">
    <div class="card-header">Local instrument — live vendor UI (via proxy)</div>
    <div class="card-body">
      <p class="muted">Embedded via the local proxy with server‑side authentication. Open in a new tab for a larger view.</p>
      <p><a target="_blank" rel="noopener" href="http://127.0.0.1:8051/">Open full vendor UI (http://127.0.0.1:8051/)</a></p>
      <div class="border rounded" style="height:540px; overflow:auto; -webkit-overflow-scrolling:touch;">
        <iframe src="http://127.0.0.1:8051/" style="width:100%; height:1200px; border:0;"></iframe>
      </div>
    </div>
  </div>

  <!-- Global seismic activity (live) -->
  <div class="card mb-4">
    <div class="card-header">Global seismic activity (live)</div>
    <div class="card-body">
      <div class="controls mb-2">
        <label>Time window:</label>
        <button class="btn" data-win="hour">Past hour</button>
        <button class="btn active" data-win="day">Past day</button>
        <button class="btn" data-win="week">Past week</button>

        <label class="ms-2">Min magnitude: <span id="mag-val">0.0</span></label>
        <input id="mag-range" type="range" min="0" max="6.5" step="0.5" value="0">

        <label class="ms-2"><input id="auto-refresh" type="checkbox"> Auto‑refresh (60 s)</label>
        <button id="refresh-btn" class="btn">Refresh now</button>
        <button id="export-csv" class="btn primary small">Export CSV</button>
        <span id="quakes-count" class="small muted"></span>
      </div>

      <div class="legend mb-2">
        <span class="dot m"></span> M&lt;3
        <span class="dot h"></span> 3≤M&lt;5
        <span class="dot d"></span> M≥5
      </div>

      <canvas id="quakes-hist" class="mb-3"></canvas>
      <div id="quakes-map" class="mb-3"></div>
      <ul id="quakes-list" class="list-unstyled mb-0">
        <li class="muted">Loading recent earthquakes…</li>
      </ul>
    </div>
  </div>

  <!-- Resources (operational) -->
  <div class="card mb-5">
    <div class="card-header">Resources</div>
    <div class="card-body">
      <ul>
        <li><a href="{{ url_for('lab') }}">Live Lab</a> — Waveform + FFT with adjustable windows.</li>
        <li><a href="{{ url_for('spectrum') }}">Spectrum</a> — Multi‑channel FFT comparison.</li>
        <li><a href="{{ url_for('data') }}">Downloads</a> — CSV for notebooks (Python/MATLAB/Octave).</li>
        <li><a href="{{ url_for('education') }}">Education</a> — Learning goals, reminders, and exercises.</li>
      </ul>
    </div>
  </div>

</div>
{% endblock %}

{% block scripts %}
  {{ super() }}
  <!-- Leaflet for the global map -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin="">
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>
  <script src="{{ url_for('static', filename='js/overview.js') }}" defer></script>
{% endblock %}